(window.webpackJsonp=window.webpackJsonp||[]).push([["login"],{"237a":function(e,t,o){"use strict";o("79cc")},5326:function(e,t,o){"use strict";o.r(t);o("a481"),o("6b54"),o("e297"),o("f386");var n={props:["type","mpanelShow","account"],data:function(){return{Mpanel:!1}},watch:{account:function(e){},mpanelShow:function(e){this.$("#mpanel").show()}},mounted:function(){this.verification()},methods:{verification:function(){var e=this;this.api.captchaPuzzle().then((function(t){var o=t;if(o.success){e.Mpanel=!0,e.$("#mpanel").fadeIn();var n=o.data;e.slidingverLogin(n)}else e.Mpanel=!1,e.$message.error(t.message)})).catch((function(t){e.Mpanel=!1,e.$message.error(t.msg)}))},slidingverLogin:function(e){var t=this,o=this.type;this.$("#mpanel .mpanel-box").empty().show(),this.$("#mpanel .mpanel-box").slideVerify({account:this.account,codeId:e.id,type:2,vOffset:o,vSpace:5,imgUrl:"data:image/png;base64,"+e.normal,smallImg:"data:image/png;base64,"+e.small,imgSize:{width:e.imgx+"px",height:e.imgy+"px"},blockSize:{width:e.sImgx+"px",height:e.sImgy+"px"},barSize:{width:e.imgx+"px",height:e.sImgx+"px"},rand2:e.y,ready:function(){},success:function(o){t.$emit("success",o+10,e.id)},error:function(e,o){t.$message.error(o.message),t.verification()},close:function(){t.$("#mpanel").hide(),t.$emit("close")}}),this.$(".verify-refresh").on("click",(function(){t.verification()}))}}},a=(o("237a"),o("2877")),s=Object(a.a)(n,(function(){var e=this.$createElement;return(this._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:this.Mpanel,expression:"Mpanel"}]},[this._m(0)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"mpanel"}},[t("div",{staticClass:"mpanel-box"})])}],!1,null,"21bf3864",null).exports,i=(o("7514"),[{code:"hk",name:"Hong Kong (香港)",dialCode:852,phoneFormat:"- --- ----",lenght:8},{code:"us",name:"United States",dialCode:1,phoneFormat:"-- --- ----",lenght:10},{code:"mo",name:"Macau (澳門)",dialCode:853,phoneFormat:"---- ----",lenght:8},{code:"tw",name:"Taiwan (台灣)",dialCode:886,phoneFormat:"--- --- ---",lenght:9},{code:"kh",name:"Cambodia (កម្ពុជា)",dialCode:855,phoneFormat:"-- --- ---",lenght:9},{code:"th",name:"Thailand (ไทย)",dialCode:66,phoneFormat:"- ---- ----",lenght:9},{code:"id",name:"Indonesia",dialCode:62,phoneFormat:"--- ------",lenght:11},{code:"io",name:"British Indian Ocean Territory",dialCode:246,phoneFormat:"--- ----",lenght:7},{code:"sg",name:"Singapore",dialCode:65,phoneFormat:"---- ----",lenght:8},{code:"vn",name:"Vietnam (Việt Nam)",dialCode:84,phoneFormat:"91 234 56 78",lenght:9},{code:"mm",name:"Myanmar (Burma) (မြန်မာ)",dialCode:95,phoneFormat:"9 212 3456",lenght:10},{code:"la",name:"Laos (ລາວ)",dialCode:856,phoneFormat:"-- -- --- ---",lenght:10},{code:"cn",name:"China (中国)",dialCode:86,phoneFormat:"--- ---- ----",lenght:11}]),l=o("8e5f"),c=o.n(l),r=(o("e607"),{name:"intlTelInput",components:{Multiselect:c.a},data:function(){return{countries:i,currentCode:i[0],hideSubMenu:!0}},mounted:function(){var e=this;this.countries.find((function(t){t.dialCode==localStorage.getItem("codeRemeber")&&(e.currentCode=t,e.$emit("excountry",t))}))},methods:{customLabel:function(e){var t=e.name,o=e.dialCode;return"".concat(t," – ").concat(o)},setCountry:function(){this.$emit("excountry",this.currentCode)}}}),d=(o("9ddd"),Object(a.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"intl-tel-input allow-dropdown"},[o("div",{staticClass:"flag-container"},[o("div",[o("multiselect",{attrs:{placeholder:"",label:"name","allow-empty":!1,options:e.countries,"option-height":104,"custom-label":e.customLabel,"show-labels":!1},on:{input:e.setCountry},scopedSlots:e._u([{key:"singleLabel",fn:function(t){return[o("span",{staticClass:"option__desc"},[o("span",{staticClass:"option__title"},[e._v("+"+e._s(t.option.dialCode))])])]}},{key:"option",fn:function(t){return[o("div",{staticClass:"flag-box"},[o("div",{class:"iti-flag "+t.option.code}),o("span",{staticClass:"option__title"},[e._v(e._s(t.option.name)+" +"+e._s(t.option.dialCode))])])]}}]),model:{value:e.currentCode,callback:function(t){e.currentCode=t},expression:"currentCode"}})],1)])])}),[],!1,null,"0d4da7ae",null).exports),m=o("5b1e"),g=o("ff25"),h={components:{Mpanels:s,IntlTelInput:d,LangTool:m.a},computed:{isMoreLog:function(){return this.setting&&this.setting.logMethods&&this.setting.logMethods.length>1}},data:function(){return{loading:!1,remember:!1,rules:{account:this.dv.MUST,password:this.dv.MUST,phone:this.dv.MUST},loginParam:{account:localStorage.getItem("account")||"",password:localStorage.getItem("password")?decodeURIComponent(localStorage.getItem("password")):"",phone:""},mobileNumb:"",codeInfo:{},setting:{},mpanelShow:!1,loginIng:!0,shwoCode:!1,eyesBtn:!1,loginType:2,siteInfo:localStorage.getItem("siteInfo")&&JSON.parse(localStorage.getItem("siteInfo"))||{},countryCode:"zh_CN",msgNum:0,userID:"",mobileNumbCode:{phoneFormat:"",dialCode:"852"},code:"",isLogin:!!sessionStorage.getItem("token"),bootShowTab:""}},watch:{},created:function(){},mounted:function(){this.getRegisterSetFunc(),this.getLogoFunc(),this.bootShowTab=1===this.loginType?this.$t("telLogin"):this.$t("accountLogin"),clearInterval(window.heartbeatInterval),window.ws&&window.ws.close(),this.$messageClose.closeAll(),g.a.emit("events","aabbj")},methods:{onMpanelSuccess:function(e,t){this.mpanelShow=!1,this.code=e+"",this.codeInfo.id=t,this.mpanelShow=!1,this.loginAjax()},close:function(){this.mpanelShow=!1},checkTab:function(){var e=1===this.loginType?2:1;this.loginType=e,this.bootShowTab=1===e?this.$t("telLogin"):this.$t("accountLogin"),this.loginParam.password=""},getLogoFunc:function(){var e=this;this.api.getSiteInfo().then((function(t){if(t&&t.success){e.siteInfo=t.data,localStorage.setItem("siteInfo",JSON.stringify(e.siteInfo)),localStorage.setItem("currencyCode",e.siteInfo.currencyCode),localStorage.setItem("cdnUrl",t.data.cdnUrl),document.title=e.siteInfo.siteName,document.cookie="currencyCode="+e.siteInfo.currencyCode,e.countryCode=e.siteInfo.langCode.toString();var o=e.siteInfo.langCode||e.DEFAULT_LANG,n=localStorage.getItem("local");o!=n&&null!=n?e.$bus.$emit("langk",e.getCommonLang(n),1):e.$bus.$emit("langk",e.getCommonLang(o),1)}else e.$message.error(t.message)}))},getRegisterSetFunc:function(){var e=this;this.api.getRegisterSet().then((function(t){t.success?(e.setting=t.data,1===e.setting.logMethods.length&&(2==e.setting.logMethod?e.loginType=2:e.loginType=1),1==e.setting.isLoginCode&&1==e.setting.loginCaptchaType&&(e.getCaptchaImg(),e.shwoCode=!0)):8233!==t.code&&e.$message.error(t.message)}))},getCaptchaImg:function(){var e=this;this.code="",this.api.getCaptchaCode().then((function(t){t.success?e.codeInfo=t.data:8233!==t.code&&e.$message.error(t.message)}))},toLogin:function(){this.loginParam.account||1!==this.loginType?this.loginParam.phone||2!==this.loginType?this.loginParam.password?1!=this.setting.isLoginCode||1!=this.setting.loginCaptchaType||this.code?/[^0-9]/g.test(this.loginParam.phone)&&2===this.loginType?this.$message.error(this.$t("wrongTelNumber")):1===this.setting.isLoginCode&&2===this.setting.loginCaptchaType?this.mpanelShow=!0:this.loginAjax():this.$message.error(this.$t("p_VerCode")):this.$message.error(this.$t("placeholder_passwordErr")):this.$message.error(this.$t("mobilePlaceholders")):this.$message.error(this.$t("placeholder_accountErr"))},loginAjax:function(){var e=this;this.loginIng=!1;var t={areaCode:"+"+(this.mobileNumbCode&&this.mobileNumbCode.dialCode),loginType:this.loginType,phone:this.loginParam.phone,account:this.loginParam.account,password:this.loginParam.password,code:this.code,codeId:this.codeInfo.id};sessionStorage.setItem("errAccount",this.account),this.loading=!0,this.api.login(t).then((function(t){e.loading=!1,t.success?(sessionStorage.setItem("token",t.data),document.cookie="s="+t.data,e.$store.dispatch("GetUserInfo").then((function(t){e.$message.success("登录成功");var o=t.id;e.userID=o,e.remember?(localStorage.setItem("account",e.loginParam.account),localStorage.setItem("password",encodeURIComponent(e.loginParam.password))):(localStorage.removeItem("account"),localStorage.removeItem("password")),1!=e.isDemo&&e.IM(),e.$router.push({name:"home"})})).catch((function(t){e.$message.error(t)}))):(5321===t.code?e.remember?(localStorage.setItem("account",e.account),localStorage.setItem("password",encodeURIComponent(e.password))):(localStorage.removeItem("account"),localStorage.removeItem("password")):(e.getCaptchaImg(),8233!==t.code&&e.$message.error(t.message)),e.loginIng=!0)})).catch((function(e){}))},getMobileNumbCode:function(e){this.mobileNumbCode=e},changeTel:function(){this.loginParam.phone=this.loginParam.phone.replace(/[^0-9]/g,"")},changeTelfocus:function(){this.loginParam.phone=/[^0-9]/g.test(this.loginParam.phone)?"":this.loginParam.phone},changeVcode:function(){this.code=this.code.replace(/[^0-9]/g,"")}}},p=(o("5bf7"),Object(a.a)(h,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-wrap"},[o("div",{staticClass:"ms-login"},[o("div",{staticClass:"ms-title"},[e._v(e._s(e.$t("managementSystem")))]),o("IntlTelInput",{directives:[{name:"show",rawName:"v-show",value:2===e.loginType,expression:"loginType === 2"}],staticClass:"mobileSelect",on:{excountry:e.getMobileNumbCode}}),o("el-form",{ref:"login",staticClass:"ms-content",attrs:{model:e.loginParam,rules:e.rules,"label-width":"0px"}},[1===e.loginType?o("span",[o("el-form-item",{attrs:{prop:"account"}},[o("el-input",{attrs:{type:"text",placeholder:e.$t("p_account")},model:{value:e.loginParam.account,callback:function(t){e.$set(e.loginParam,"account",t)},expression:"loginParam.account"}},[o("el-button",{attrs:{slot:"prepend",icon:"el-icon-user"},slot:"prepend"})],1)],1)],1):e._e(),2===e.loginType?o("span",[o("el-form-item",{attrs:{prop:"phone"}},[o("el-input",{staticClass:"phone",attrs:{name:"phone",type:"text",autoComplete:"on",placeholder:e.mobileNumbCode.phoneFormat},on:{focus:e.changeTelfocus},nativeOn:{keyup:function(t){return e.changeTel.apply(null,arguments)}},model:{value:e.loginParam.phone,callback:function(t){e.$set(e.loginParam,"phone",t)},expression:"loginParam.phone"}})],1)],1):e._e(),o("el-form-item",{attrs:{prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:e.$t("p_pwd")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.toLogin()}},model:{value:e.loginParam.password,callback:function(t){e.$set(e.loginParam,"password",t)},expression:"loginParam.password"}},[o("el-button",{attrs:{slot:"prepend",icon:"el-icon-lock"},slot:"prepend"})],1)],1),1==e.setting.isLoginCode&&1==e.setting.loginCaptchaType?o("el-form-item",{staticClass:"vertiCode"},[o("el-input",{attrs:{type:"text",maxlength:"4",placeholder:e.$t("p_VerCode")},nativeOn:{keyup:[function(t){return e.changeVcode.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.toLogin()}]},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}},[o("el-button",{attrs:{slot:"prepend"},slot:"prepend"},[e._v(e._s(e.$t("verCode")))]),o("el-button",{attrs:{slot:"append"},slot:"append"},[e.codeInfo.code?o("img",{staticClass:"login-code-img code-imgbg",attrs:{src:"data:image/png;base64,"+e.codeInfo.code,alt:""},on:{click:e.getCaptchaImg}}):e._e()])],1)],1):e._e(),o("div",{staticClass:"tools"},[e.isMoreLog?o("a",{on:{click:function(t){return e.checkTab()}}},[e._v(e._s(e.bootShowTab))]):e._e(),o("el-checkbox",{staticClass:"remembtn",attrs:{disabled:""},model:{value:e.remember,callback:function(t){e.remember=t},expression:"remember"}},[e._v(e._s(e.$t("rememberPassword")))]),o("LangTool",{staticClass:"langs"})],1),o("div",{staticClass:"login-btn"},[o("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,size:"small",type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.toLogin()}}},[e.loading?o("span",[e._v(e._s(e.$t("loginIng"))+"...")]):o("span",[e._v(e._s(e.$t("login")))])])],1),o("div",{staticClass:"bot-tool"})],1),e.mpanelShow?o("Mpanels",{attrs:{type:1,account:e.loginParam.account},on:{success:e.onMpanelSuccess,close:e.close}}):e._e()],1)])}),[],!1,null,"48ce81c2",null));t.default=p.exports},"5bf7":function(e,t,o){"use strict";o("b27b")},"79cc":function(e,t,o){},"9ddd":function(e,t,o){"use strict";o("f81c")},b27b:function(e,t,o){},f81c:function(e,t,o){}}]);